"use strict";(()=>{var T=(n,r)=>()=>(r||n((r={exports:{}}).exports,r),r.exports);var I=T((x,M)=>{(function(n,r){typeof x=="object"&&typeof M!="undefined"?r(x):typeof define=="function"&&define.amd?define(["exports"],r):r(n.WHATWGFetch={})})(x,function(n){"use strict";var r=typeof globalThis!="undefined"&&globalThis||typeof self!="undefined"&&self||typeof r!="undefined"&&r,o={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function f(t){return t&&DataView.prototype.isPrototypeOf(t)}if(o.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&w.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function v(t){return typeof t!="string"&&(t=String(t)),t}function E(t){var e={next:function(){var i=t.shift();return{done:i===void 0,value:i}}};return o.iterable&&(e[Symbol.iterator]=function(){return e}),e}function a(t){this.map={},t instanceof a?t.forEach(function(e,i){this.append(i,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}a.prototype.append=function(t,e){t=c(t),e=v(e);var i=this.map[t];this.map[t]=i?i+", "+e:e},a.prototype.delete=function(t){delete this.map[c(t)]},a.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},a.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},a.prototype.set=function(t,e){this.map[c(t)]=v(e)},a.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},a.prototype.keys=function(){var t=[];return this.forEach(function(e,i){t.push(i)}),E(t)},a.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),E(t)},a.prototype.entries=function(){var t=[];return this.forEach(function(e,i){t.push([i,e])}),E(t)},o.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function $(t){var e=new FileReader,i=m(e);return e.readAsArrayBuffer(t),i}function G(t){var e=new FileReader,i=m(e);return e.readAsText(t),i}function z(t){for(var e=new Uint8Array(t),i=new Array(e.length),u=0;u<e.length;u++)i[u]=String.fromCharCode(e[u]);return i.join("")}function U(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:o.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o.arrayBuffer&&o.blob&&f(t)?(this._bodyArrayBuffer=U(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=U(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=d(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then($)}),this.text=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return G(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(z(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var X=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function W(t){var e=t.toUpperCase();return X.indexOf(e)>-1?e:t}function g(t,e){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var i=e.body;if(t instanceof g){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new a(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!i&&t._bodyInit!=null&&(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new a(e.headers)),this.method=W(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var u=/([?&])_=[^&]*/;if(u.test(this.url))this.url=this.url.replace(u,"$1_="+new Date().getTime());else{var h=/\?/;this.url+=(h.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})};function J(t){var e=new FormData;return t.trim().split("&").forEach(function(i){if(i){var u=i.split("="),h=u.shift().replace(/\+/g," "),s=u.join("=").replace(/\+/g," ");e.append(decodeURIComponent(h),decodeURIComponent(s))}}),e}function K(t){var e=new a,i=t.replace(/\r?\n[\t ]+/g," ");return i.split("\r").map(function(u){return u.indexOf(`
`)===0?u.substr(1,u.length):u}).forEach(function(u){var h=u.split(":"),s=h.shift().trim();if(s){var B=h.join(":").trim();e.append(s,B)}}),e}R.call(g.prototype);function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new a(e.headers),this.url=e.url||"",this._initBody(t)}R.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var Q=[301,302,303,307,308];b.redirect=function(t,e){if(Q.indexOf(e)===-1)throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},n.DOMException=r.DOMException;try{new n.DOMException}catch(t){n.DOMException=function(e,i){this.message=e,this.name=i;var u=Error(e);this.stack=u.stack},n.DOMException.prototype=Object.create(Error.prototype),n.DOMException.prototype.constructor=n.DOMException}function P(t,e){return new Promise(function(i,u){var h=new g(t,e);if(h.signal&&h.signal.aborted)return u(new n.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function B(){s.abort()}s.onload=function(){var y={status:s.status,statusText:s.statusText,headers:K(s.getAllResponseHeaders()||"")};y.url="responseURL"in s?s.responseURL:y.headers.get("X-Request-URL");var O="response"in s?s.response:s.responseText;setTimeout(function(){i(new b(O,y))},0)},s.onerror=function(){setTimeout(function(){u(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){u(new TypeError("Network request failed"))},0)},s.onabort=function(){setTimeout(function(){u(new n.DOMException("Aborted","AbortError"))},0)};function Y(y){try{return y===""&&r.location.href?r.location.href:y}catch(O){return y}}s.open(h.method,Y(h.url),!0),h.credentials==="include"?s.withCredentials=!0:h.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(o.blob?s.responseType="blob":o.arrayBuffer&&h.headers.get("Content-Type")&&h.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof a)?Object.getOwnPropertyNames(e.headers).forEach(function(y){s.setRequestHeader(y,v(e.headers[y]))}):h.headers.forEach(function(y,O){s.setRequestHeader(O,y)}),h.signal&&(h.signal.addEventListener("abort",B),s.onreadystatechange=function(){s.readyState===4&&h.signal.removeEventListener("abort",B)}),s.send(typeof h._bodyInit=="undefined"?null:h._bodyInit)})}P.polyfill=!0,r.fetch||(r.fetch=P,r.Headers=a,r.Request=g,r.Response=b),n.Headers=a,n.Request=g,n.Response=b,n.fetch=P,Object.defineProperty(n,"__esModule",{value:!0})})});var F=T((it,S)=>{I();S.exports=self.fetch.bind(self)});var V=T(_=>{"use strict";var Z=_&&_.__awaiter||function(n,r,o,f){function w(l){return l instanceof o?l:new o(function(c){c(l)})}return new(o||(o=Promise))(function(l,c){function v(d){try{a(f.next(d))}catch(m){c(m)}}function E(d){try{a(f.throw(d))}catch(m){c(m)}}function a(d){d.done?l(d.value):w(d.value).then(v,E)}a((f=f.apply(n,r||[])).next())})};Object.defineProperty(_,"__esModule",{value:!0});_.Nodes=void 0;F();var H=class{constructor(){this.nodeIndex=-1,this.committee=new Set,this.topology=[]}init(r){return Z(this,void 0,void 0,function*(){this.nodeIndex=-1,this.committee.clear(),this.topology=[];let o=[];try{o=yield(yield fetch(r)).json()}catch(f){throw new Error(`exception in fetch(${r}): ${f}`)}for(let f of o)f.Healthy==="1"&&this.topology.push(f);if(this.topology.length===0)throw new Error("no healthy nodes retrieved")})}getNextNode(r=!0){for(;;)return this.nodeIndex++,this.nodeIndex>=this.topology.length&&(this.nodeIndex=0),this.topology[this.nodeIndex]}getRandomNode(r=!0){let o=Math.floor(Math.random()*this.topology.length);return this.topology[o]}};_.Nodes=H});var L=T(p=>{"use strict";var A=p&&p.__awaiter||function(n,r,o,f){function w(l){return l instanceof o?l:new o(function(c){c(l)})}return new(o||(o=Promise))(function(l,c){function v(d){try{a(f.next(d))}catch(m){c(m)}}function E(d){try{a(f.throw(d))}catch(m){c(m)}}function a(d){d.done?l(d.value):w(d.value).then(v,E)}a((f=f.apply(n,r||[])).next())})};Object.defineProperty(p,"__esModule",{value:!0});p.getHttpV4Endpoint=p.getHttpV4Endpoints=p.getHttpEndpoint=p.getHttpEndpoints=p.Access=void 0;var tt=V(),D=class{constructor(){this.host="ton.access.orbs.network",this.urlVersion=1,this.nodes=new tt.Nodes}init(){return A(this,void 0,void 0,function*(){yield this.nodes.init(`https://${this.host}/nodes`)})}buildUrls(r,o,f){f||(f=""),f.length&&(f=f.replace(/^\/+/,""));let w=[],l=this.nodes.topology.length;for(let c=0;c<l;++c){let v=this.nodes.getNextNode(),E=`https://${this.host}/${v.Name}/${this.urlVersion}/${r}/${o}/${f}`;w.push(E)}return w}};p.Access=D;function q(n,r,o){return A(this,void 0,void 0,function*(){let f=new D;return yield f.init(),f.buildUrls(n,r,o)})}function N(n){return A(this,void 0,void 0,function*(){let r=n!=null&&n.network?n.network:"mainnet",o="jsonRPC";return(n==null?void 0:n.protocol)==="rest"&&(o=""),yield q(r,"toncenter-api-v2",o)})}p.getHttpEndpoints=N;function et(n){return A(this,void 0,void 0,function*(){let r=yield N(n),o=Math.floor(Math.random()*r.length);return r[o]})}p.getHttpEndpoint=et;function k(n){return A(this,void 0,void 0,function*(){let r=n!=null&&n.network?n.network:"mainnet";if((n==null?void 0:n.protocol)==="json-rpc")throw Error("config.protocol json-rpc is not supported for getTonApiV4Endpoints");return yield q("mainnet","ton-api-v4","")})}p.getHttpV4Endpoints=k;function rt(n){return A(this,void 0,void 0,function*(){let r=yield k(n),o=Math.floor(Math.random()*r.length);return r[o]})}p.getHttpV4Endpoint=rt});var nt=T(C=>{Object.defineProperty(C,"__esModule",{value:!0});var j=L();window.TonAccess={create:()=>new j.Access,getHttpEndpoint:j.getHttpEndpoint,getHttpV4Endpoint:j.getHttpV4Endpoint}});nt();})();
